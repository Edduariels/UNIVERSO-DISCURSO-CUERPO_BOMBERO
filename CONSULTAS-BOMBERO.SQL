--Autor:Eddu Ariel Saldarriaga Carrillo
--Materia:Gestion de Base de Datos 5 "A"
--Docente: Robert Moreira
--Tema:Univero Discurso Cuerpo De Bomberos
--Fecha:20/11/2022
--LENGUAJE PROCEDIMENTAL PLSQL ORACLE



SELECT NOMBRE AS INSTRUMENTO, SUM(CANTIDADASIGNADA) AS TOTALEQUIPOSASINADOS, MAX(EXTRACT (YEAR FROM FECHAASIGNADA)) AS Aﾃ前
    FROM ASIGNACION A 
    INNER JOIN INSTRUMENTOS I  ON I.IDISNTRUMENTO = A.FK_IDINSTRUMENTOS
    WHERE EXTRACT (YEAR FROM FECHAASIGNADA  )= 2020
    GROUP BY NOMBRE;
    
SELECT RANGO, COUNT(IDPROMOCION) AS PERSONASASCENDIDAS, MAX (EXTRACT (YEAR FROM FECHAPROMOCION)) AS Aﾃ前
    FROM PROMOCION P 
    INNER JOIN BOMBERO B  ON B.IDBOMBERO = P.FK_IDBOMBERO
    INNER JOIN RANGO R  ON R.IDRANGO = P.FK_IDRANGO
    WHERE EXTRACT (YEAR FROM FECHAPROMOCION  )= 2019
    GROUP BY RANGO;
    
SELECT NOMBRES, COUNT(FK_IDBOMBERO) AS CURSOSREALIZADOS, MAX (EXTRACT (YEAR FROM FECHACURSO)) AS Aﾃ前
    FROM CURSOS C 
    INNER JOIN BOMBERO B  ON B.IDBOMBERO = C.FK_IDBOMBERO
    WHERE EXTRACT (YEAR FROM FECHACURSO  )= 2020
    GROUP BY NOMBRES;
    
    
SELECT ENTIDAD,NOMBRE, SUM(CANTIDADINGRESADA) AS DONADO, MAX (EXTRACT (YEAR FROM FECHAINGRESO)) AS Aﾃ前
    FROM INGRESOINSTRUMENTOS I 
    INNER JOIN ORIGEN O  ON O.IDORIGEN = I.FK_IDORIGEN
    INNER JOIN INSTRUMENTOS IT  ON IT.IDISNTRUMENTO = I.FK_IDINSTRUMENTOS
    WHERE EXTRACT (YEAR FROM FECHAINGRESO  )= 2020
    GROUP BY ENTIDAD,NOMBRE;